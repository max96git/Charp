<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Games</title>
    <style>
        #games-list {
            display: flex;
            flex-wrap: wrap;
        }
        .game-card {
            margin: 10px;
            border: 1px solid #ccc;
            padding: 10px;
            width: 200px;
        }
        canvas { 
            width: 200px; 
            height: 150px; 
            border: 1px solid black; 
        }
    </style>
</head>
<body>
    <h1>Available Games</h1>
    <div id="games-list"></div>

    <script>
        async function fetchGames() {
            try {
                const response = await fetch('/api/games');
                if (!response.ok) {
                    throw new Error('Failed to fetch games');
                }
                const games = await response.json();
                return games;
            } catch (error) {
                console.error('Error fetching games:', error);
                return [];
            }
        }

        function displayGames(games) {
            const gamesList = document.getElementById('games-list');
            gamesList.innerHTML = ''; // Clear existing games
            games.forEach(game => {
                const gameCard = document.createElement('div');
                gameCard.className = 'game-card';
                gameCard.innerHTML = `
                    <h2>${game.title}</h2>
                    <canvas id="game-canvas-${game.id}"></canvas>
                    <p>${game.description}</p>
                    <a href="game-play.html?id=${game.id}">Play Now</a>
                `;
                gamesList.appendChild(gameCard);
                renderGame3D(game.id, game.gameData); // Call to render 3D game
            });
        }

        async function loadGames() {
            const games = await fetchGames();
            displayGames(games);
        }

        function renderGame3D(gameId, gameData) {
            const canvas = document.getElementById(`game-canvas-${gameId}`);
            const ctx = canvas.getContext('2d');

            ctx.fillStyle = 'lightblue'; // Placeholder color for the game
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // If you have 3D models, you can load them here based on gameData
        }

        loadGames();
        setInterval(loadGames, 5000);
    </script>
</body>
</html>
